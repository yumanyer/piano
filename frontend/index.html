<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MANUS-TILES</title>

    <!-- Carga CSS usando ruta relativa (asume style.css est√° en la misma carpeta 'frontend') -->
    <link rel="stylesheet" href="style.css">
    <!-- O puedes usar ruta absoluta desde la ra√≠z si prefieres: -->
    <!-- <link rel="stylesheet" href="/style.css"> -->

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <!-- *** NUEVO: Scripts de MediaPipe Hands y DrawingUtils desde CDN *** -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <!-- ************************************************************** -->

</head>
<body>
    <!-- Setup de C√°mara -->
    <div id="cameraSetup" style="display: flex;"> <!-- Visible inicialmente -->
        <h2>Configuraci√≥n de C√°mara</h2>
        <p id="cameraStatusMessage">Haz clic para buscar c√°maras disponibles.</p>
        <div style="margin-bottom: 20px;">
            <button id="requestCameraButton" class="button">Buscar C√°maras</button>
            <select id="cameraSelect" style="display: none;"></select>
            <!-- El bot√≥n ahora solo iniciar√° el video localmente -->
            <button id="confirmCameraButton" class="button blue" style="display: none;">Iniciar C√°mara</button>
        </div>
        <p style="font-size: 0.9em; color: #ccc;">Necesitar√°s dar permiso para acceder a tu c√°mara.</p>
    </div>

    <!-- Modal -->
    <div class="modal" id="infoModal">
        <div class="modal-content">
            <span class="close-modal" id="closeModal">√ó</span>
            <p class="modal-description">
                Este proyecto est√° dise√±ado para detectar y rastrear el movimiento de la mano en tiempo real. A trav√©s de un sistema de seguimiento, se detecta cuando las puntas de los dedos superan los nudillos, lo que activa la reproducci√≥n de un sonido predefinido. Los sonidos, que pueden ser personalizados y cargados de manera local por ustedes mismos, se reproducen en funci√≥n de los movimientos de cada dedo, creando una experiencia interactiva y √∫nica.
            </p>
            <button class="button" id="confirmModal">Entendido</button>
        </div>
    </div>

<div class="container" style="display: none;"> <!-- Contenedor principal oculto inicialmente -->
    <div class="header">
        <div class="question" id="showModal">¬øQu√© es esto?</div>
        <div class="title">MANUS-TILES</div>
    </div>

    <div class="main-content">
        <!-- Sidebar Izquierda -->
        <div class="sidebar left-sidebar">
             <div class="sidebar-title">
                <span>IZQUIERDA</span>
                <span class="hand-icon">üëã</span>
            </div>
            <ul class="file-list">
                <!-- IDs a√±adidos finger-item-X donde X es el √≠ndice 0-9 -->
                <!-- Mapeo: file6 -> index 5, file7 -> index 6, ... file10 -> index 9 -->
                <li class="file-item" id="finger-item-5"><span class="finger-status-indicator"></span><span class="file-item-num">6.</span><input class="custom-input" type="file" accept="audio/*"  data-key="5" id="file6"></li>
                <li class="file-item" id="finger-item-6"><span class="finger-status-indicator"></span><span class="file-item-num">7.</span><input class="custom-input" type="file" accept="audio/*"  data-key="6"id="file7"></li>
                <li class="file-item" id="finger-item-7"><span class="finger-status-indicator"></span><span class="file-item-num">8.</span><input class="custom-input" type="file" accept="audio/*" data-key="7" id="file8"></li>
                <li class="file-item" id="finger-item-8"><span class="finger-status-indicator"></span><span class="file-item-num">9.</span><input class="custom-input" type="file" accept="audio/*" data-key="8" id="file9"></li>
                <li class="file-item" id="finger-item-9"><span class="finger-status-indicator"></span><span class="file-item-num">10.</span><input class="custom-input" type="file" accept="audio/*" data-key="9" id="file10"></li>
            </ul>
        </div>

        <!-- Panel Principal con Video y Canvas -->
        <div class="main-panel" id="mainPanel">
             <div class="video-container">
                 <p id="connectionStatus" class="status-text">Esperando selecci√≥n de c√°mara...</p>
                 <!-- Contenedor para superponer canvas sobre video -->
                 <div style="position: relative; width: 640px; height: 480px; margin: auto; border: 1px solid rgba(255,255,255,0.3); background-color: rgba(0,0,0,0.3);">
                     <!-- Video para mostrar el stream de la c√°mara (oculto visualmente si se dibuja en canvas, pero necesario para MediaPipe) -->
                     <video id="videoFeed" autoplay playsinline style="display: block; width: 100%; height: 100%; object-fit: cover; transform: scaleX(1);"></video>
                     <!-- Canvas para dibujar los resultados de MediaPipe -->
                     <canvas id="outputCanvas" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></canvas>
                 </div>
             </div>
            <div class="circle-button" id="fullscreenBtn">‚õ∂</div>
        </div>

        <!-- Sidebar Derecha -->
        <div class="sidebar right-sidebar">
             <div class="sidebar-title">
                <span>DERECHA</span>
                <span class="hand-icon">üëã</span>
            </div>
            <ul class="file-list">
                 <!-- Mapeo: file1 -> index 0, file2 -> index 1, ... file5 -> index 4 -->
                <li class="file-item" id="finger-item-0"><span class="finger-status-indicator"></span><span class="file-item-num">1.</span><input class="custom-input" type="file" accept="audio/*" data-key="0" id="file1"></li>
                <li class="file-item" id="finger-item-1"><span class="finger-status-indicator"></span><span class="file-item-num">2.</span><input class="custom-input" type="file" accept="audio/*" data-key="1" id="file2"></li>
                <li class="file-item" id="finger-item-2"><span class="finger-status-indicator"></span><span class="file-item-num">3.</span><input class="custom-input" type="file" accept="audio/*" data-key="2" id="file3"></li>
                <li class="file-item" id="finger-item-3"><span class="finger-status-indicator"></span><span class="file-item-num">4.</span><input class="custom-input" type="file" accept="audio/*"  data-key="3" id="file4"></li>
                <li class="file-item" id="finger-item-4"><span class="finger-status-indicator"></span><span class="file-item-num">5.</span><input class="custom-input" type="file" accept="audio/*"  data-key="4" id="file5"></li>
            </ul>
        </div>
    </div>

    <!-- Botones del pie de p√°gina (Descomentar si los usas) -->
    <!-- <div class="footer-buttons" style="text-align: center; margin-top: 20px;">
        <button id="saveButton" class="button">Guardar Sonidos</button>
        <button id="playButton" class="button blue">Tocar (Fullscreen)</button>
    </div> -->

</div> <!-- Fin .container -->

<!-- Carga JS al final, usando ruta relativa (asume index.js est√° en la misma carpeta 'frontend') -->
<script src="index.js" defer></script>
<!-- O puedes usar ruta absoluta desde la ra√≠z si prefieres: -->
<!-- <script src="/index.js" defer></script> -->

</body>
</html>